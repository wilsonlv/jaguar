<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jaguar.modules.system.mgm.mapper.UserRoleMapper">

	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="org.jaguar.modules.system.mgm.model.UserRole">
		<id column="id" property="id" />
		<result column="user_id" property="userId" />
		<result column="role_id" property="roleId" />
		<association property="role" javaType="org.jaguar.modules.system.mgm.model.Role">
			<result column="role_name" property="roleName" />
			<result column="role_data_scope" property="roleDataScope" />
			<result column="role_locked" property="roleLocked" />
		</association>
	</resultMap>

	<select id="listWithRoleByUserId" resultMap="BaseResultMap">
		SELECT
			ur.*, r.*
		FROM t_system_user_role ur
		LEFT JOIN t_system_role r ON r.id_ = ur.role_id
		WHERE
			ur.deleted_ = 0
			AND r.deleted_ = 0
			AND r.role_locked = 0
			AND ur.user_id = #{userId}
	</select>
	
</mapper>
